!function(){var a=function(a){return function(b,c,d){c=c.split("."),a(b,c[0],d,c.length-1)}},b=function(a,b,c){if(!b)return a;for(var d=b.split(".");d.length>1&&(a=a[d.shift()],void 0!=a););return 2===arguments.length?a[d.shift()]:(a[d.shift()]=c,void 0)};rivets.configure({adapter:{subscribe:a(watch),unsubscribe:a(unwatch),read:b,publish:b},handler:function(a,b,c){return $(a).data("default")||b.preventDefault(),this.call(c.model,c)}})}(),function(){var a=[].slice,b=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=0|16*Math.random(),c="x"==a?b:8|3&b;return c.toString(16)})},c=function(a,b,c,d){return c=c?"get"==a?$.param(c):JSON.stringify(c):null,$.ajax({type:a,url:b,data:c,success:d,dataType:"json",processData:!1,contentType:"application/json"})},d=function(a,b){this._collection=b||this._collection,$.extend(this,a)};$.extend(d.prototype,{_parse:function(a){return a},_callback:function(a){a=this._parse(a),!this._id&&this._collection&&this._collection.move(this,this._id),$.extend(this,a)},_clean:function(){var a;for(a in this)this.hasOwnProperty(a)&&"_"!=a[0]&&(this[a]="")},toJSON:function(){var a,b={};for(a in this)this.hasOwnProperty(a)&&"_"!=a[0]&&(b[a]=this[a]);return b},fetch:function(a){return c("get",this._url+this._id,a,this._callback.bind(this))},save:function(){return c(this._id?"put":"post",this._url+this._id,this,this._callback.bind(this))},saveAs:function(){var a=this.toJSON();return this._clean(),this._collection.push(a).save()},"delete":function(){return this._id?c("delete",this._url+this._id,{},function(){this._clean(),this._destroyed=!0}.bind(this)):(this._clean(),this._destroyed=!0,void 0)}});var e=function(a,b,c){"string"==typeof b&&(c=b,b=null),this.model=b||this.model||d,this.url=c||this.url||this.model.prototype._url,this.clean(),a&&this.push(a)};$.extend(e.prototype,{clean:function(){return this.list=[],this.byId={},this},fetch:function(a){return c("get",this.url,a,function(a){this.push(a)}.bind(this))},push:function(a){return Array.isArray(a)?(a.forEach(this.push.bind(this)),this.filled=!0,!1):(a=a instanceof d?a:new this.model(a,this),a._collection=this,this.filled&&(a._new=!0),watch(a,"_destroyed",function(b,c,d){d&&this.remove(a)}.bind(this)),this.byId[a._id||b()]=a,this.list.push(a),a)},remove:function(a){this.list.splice(this.list.indexOf(a),1),callWatchers(this)}});var f=function(a,b){this.template||(this.template=b),this.data=$.extend({},this.data,a),this.data.tpl=this};$.extend(f.prototype,{render:function(a){return this.template?(a||(a=this.ready),witch.config.template(this.template,function(b,c){this.el=c,this.binding=rivets.bind(this.el,this.data),a&&a.call(this)}.bind(this)),this):console.error("No template",this)}}),window.witch={Model:d,Collection:e,Template:f,config:{template:function(a,b){var c=$('[data-template="'+a+'"] > :not(:empty)').clone();b(!c.length,c)},preload:!0},init:function(){$("[data-rivets]").each(function(){var a=$(this),b=window[a.data("rivets")];b&&(b._rivets=rivets.bind(a,b))})},inherit:function(){var b=a.call(arguments),c=b[0],d=function(){c.apply(this,arguments)};return b.unshift(d),$.extend.apply(this,b.map(function(a){return"function"==typeof a?a.prototype:a})),d},rest:c},$(function(){witch.config.preload&&witch.init()})}();